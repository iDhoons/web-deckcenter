---
// 홈페이지에서만 스플래시 렌더링
const isHomePage = Astro.url.pathname === '/';
---

{isHomePage && (
  <div class="splash" id="splash" aria-hidden="true">
    <img src="/images/Logo_Urizen.svg" alt="" class="logo" />
  </div>
)}

<style>
  .splash {
    position: fixed;
    inset: 0;
    z-index: var(--z-splash, 10000);
    display: flex;
    align-items: center;
    justify-content: center;
    background: #ffffff;
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
    transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
  }

  .splash.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }

  .splash.removed {
    display: none;
  }

  .logo {
    width: min(280px, 70vw);
  }

  @media (prefers-reduced-motion: reduce) {
    .splash {
      transition: none;
    }
  }
</style>

<script>
  const SPLASH_KEY = 'deckctr_splash_shown';
  const SPLASH_DELAY = 1500;
  const FADE_DURATION = 800;

  function initSplash() {
    const splash = document.getElementById('splash');
    if (!splash) return;

    // 이미 본 경우 즉시 숨김
    if (sessionStorage.getItem(SPLASH_KEY)) {
      splash.classList.add('hidden', 'removed');
      window.dispatchEvent(new CustomEvent('splash:complete'));
      return;
    }

    // 첫 방문: 스플래시 표시 후 페이드아웃
    document.body.style.overflow = 'hidden';

    setTimeout(() => {
      splash.classList.add('hidden');
      sessionStorage.setItem(SPLASH_KEY, 'true');

      setTimeout(() => {
        splash.classList.add('removed');
        document.body.style.overflow = '';
        window.dispatchEvent(new CustomEvent('splash:complete'));
      }, FADE_DURATION);
    }, SPLASH_DELAY);
  }

  document.addEventListener('astro:page-load', initSplash);
</script>
