---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import Card from '../components/Card.astro';
import Section from '../components/Section.astro';
import CTA from '../components/CTA.astro';
import Testimonial from '../components/Testimonial.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

const products: CollectionEntry<'products'>[] = await getCollection('products');

const cases: CollectionEntry<'cases'>[] = (await getCollection('cases')).slice(0, 3);

const blogPosts: CollectionEntry<'blog'>[] = (await getCollection('blog'))
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
const guidePosts = blogPosts
  .filter((post) => post.data.tags.includes('소재비교') || post.data.tags.includes('가이드'))
  .slice(0, 3);

const productCards = [
  {
    title: "목재 데크",
    description: "자연의 질감과 따뜻한 감성",
    image: "https://images.unsplash.com/photo-1590059392209-799446d3283c?auto=format&fit=crop&q=80&w=800",
    link: "/products/wood"
  },
  {
    title: "합성목/WPC",
    description: "유지보수 걱정 없는 현대적 솔루션",
    image: "https://images.unsplash.com/photo-1544033333-722a4667469a?auto=format&fit=crop&q=80&w=800",
    link: "/products/composite"
  },
  {
    title: "알루미늄 데크",
    description: "반영구적 수명과 완벽한 내화성",
    image: "https://images.unsplash.com/photo-1598928506311-c55ded91a20c?auto=format&fit=crop&q=80&w=800",
    link: "/products/aluminum"
  },
  {
    title: "부자재/난간",
    description: "시공의 완성도를 높이는 디테일",
    image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&q=80&w=800",
    link: "/products/accessories"
  }
];
---

<BaseLayout>
  <div class="hero-wrap">
    <Hero
      eyebrow="합성데크 · 합성목재 · 데크"
      title="현장에 맞는 데크 솔루션, 데크센터"
      description="시공업자와 일반 소비자 모두를 위한 내구성·품질·A/S 기준을 제안합니다. 공간과 예산에 맞는 자재를 전문가가 추천합니다."
      ctaText="견적 문의하기"
      ctaLink="https://calc.deckctr.com"
      videoUrl="/videos/hero-forest.mp4"
      image="https://images.unsplash.com/photo-1590059392209-799446d3283c?auto=format&fit=crop&q=80&w=1200"
      highlights={["내구성 기준 제안", "품질 기준 공개", "A/S 대응"]}
    />
  </div>

  <Section
    title="데크센터가 신뢰받는 이유"
    description="내구성, 품질, A/S 기준을 명확히 설명해 선택을 단순하게 만듭니다."
    variant="alt"
  >
    <div class="trust-grid">
      <div class="trust-item">
        <h3>내구성 기준</h3>
        <p>현장 환경과 사용 빈도를 고려해 수명 기준을 제안합니다.</p>
      </div>
      <div class="trust-item">
        <h3>품질 기준</h3>
        <p>소재 구조와 표면 품질 기준을 투명하게 안내합니다.</p>
      </div>
      <div class="trust-item">
        <h3>A/S 대응</h3>
        <p>유지관리와 보수 절차를 미리 정리해 제공합니다.</p>
      </div>
    </div>
  </Section>

  <Section
    title="제품 카테고리"
    description="목재부터 합성목, 알루미늄까지 목적에 맞는 자재를 한눈에 비교하세요."
  >
    <div class="products-grid">
      {productCards.map(card => (
        <Card {...card} />
      ))}
    </div>
  </Section>

  <Section
    title="상담부터 납품까지"
    description="상담과 견적, 납품까지의 흐름을 명확히 안내합니다."
    variant="alt"
  >
    <ol class="process-steps">
      <li class="process-step">
        <span class="step-number">01</span>
        <h3>현장 조건 파악</h3>
        <p>사용 목적, 환경, 예산을 기준으로 조건을 정리합니다.</p>
      </li>
      <li class="process-step">
        <span class="step-number">02</span>
        <h3>자재 추천</h3>
        <p>내구성과 디자인을 균형 있게 고려한 자재를 제안합니다.</p>
      </li>
      <li class="process-step">
        <span class="step-number">03</span>
        <h3>견적 확정</h3>
        <p>수량과 일정에 맞춘 견적을 빠르게 확정합니다.</p>
      </li>
      <li class="process-step">
        <span class="step-number">04</span>
        <h3>납품 및 관리</h3>
        <p>납품 이후 유지관리와 A/S 절차를 안내합니다.</p>
      </li>
    </ol>
  </Section>

  <Section
    title="고객 후기"
    description="데크센터와 함께한 고객들의 생생한 후기를 확인하세요."
  >
    <div class="testimonials-grid">
      <Testimonial
        name="김OO 대표"
        company="카페 테라스 운영"
        content="합성목 데크 시공 후 유지보수가 정말 편해졌습니다. 비 온 다음 날도 물 마름이 빠르고, 손님들 반응도 좋아요."
        rating={5}
        project="판교 카페 테라스 - 합성목 시공"
      />
      <Testimonial
        name="박OO님"
        company="한남동 주택 시공"
        content="알루미늄 데크로 교체하고 나서 10년은 걱정 없겠다는 생각이 들었습니다. 전문적인 상담과 깔끔한 시공에 만족합니다."
        rating={5}
        project="한남동 주택 알루미늄 데크"
      />
      <Testimonial
        name="이OO 과장"
        company="공공시설 관리"
        content="대량 납품이었는데 일정 맞춰 정확하게 배송해주셨고, 품질도 균일해서 시공팀에서도 만족했습니다."
        rating={5}
        project="공공시설 목재 데크 납품"
      />
      <Testimonial
        name="정OO님"
        company="다세대 주택"
        content="베란다 합성목 시공 후 여름에도 맨발로 다닐 수 있어 좋아요. 처음 상담부터 A/S까지 꼼꼼하게 안내받았습니다."
        rating={5}
        project="다세대 주택 베란다 시공"
      />
    </div>

    <div class="stats-grid">
      <div class="stat-item">
        <span class="stat-number">500+</span>
        <span class="stat-label">완료 프로젝트</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">98%</span>
        <span class="stat-label">고객 만족도</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">15년</span>
        <span class="stat-label">업계 경력</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">5년</span>
        <span class="stat-label">품질 보증</span>
      </div>
    </div>
  </Section>

  <Section
    title="시공사례"
    description="실제 현장에서 적용된 사례로 성능과 분위기를 확인하세요."
  >
    <div class="cases-grid">
      {cases.map((c) => (
        <Card
          title={c.data.title}
          description={c.data.excerpt}
          image={c.data.cover}
          link={`/cases/${c.slug}`}
        />
      ))}
    </div>
    <div class="more-link">
      <a href="/cases">더 많은 시공사례 보기 →</a>
    </div>
  </Section>

  <Section
    title="비교/가이드"
    description="자재 선택 기준과 유지관리 팁을 쉽고 빠르게 정리했습니다."
    variant="alt"
  >
    <div class="guides-grid">
      {guidePosts.map((post) => (
        <article class="guide-card">
          <a href={`/blog/${post.slug}`} class="guide-media">
            <img src={post.data.cover} alt={post.data.title} loading="lazy" />
          </a>
          <div class="guide-content">
            <div class="guide-tags">
              {post.data.tags.slice(0, 2).map((tag) => (
                <span class="guide-tag">{tag}</span>
              ))}
            </div>
            <h3><a href={`/blog/${post.slug}`}>{post.data.title}</a></h3>
            <p>{post.data.excerpt}</p>
          </div>
        </article>
      ))}
    </div>
    <div class="more-link">
      <a href="/guides">비교/가이드 더 보기 →</a>
    </div>
  </Section>

  <Section title="견적 문의" description="프로젝트 조건을 알려주시면 가장 적합한 자재로 제안드립니다.">
    <div class="cta-section">
      <p>전문 상담을 통해 현장에 맞는 자재와 견적을 빠르게 안내합니다.</p>
      <CTA text="견적내기" link="https://calc.deckctr.com" variant="primary" />
    </div>
  </Section>

  <section class="social-section">
    <div class="social-container">
      <h2>소셜 미디어에서 만나요</h2>
      <p>최신 시공 사례와 데크 관련 팁을 확인하세요</p>
      <div class="social-icons">
        <a href="https://www.instagram.com/deckctr" target="_blank" rel="noopener noreferrer" aria-label="인스타그램" class="social-icon instagram">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
          </svg>
          <span>Instagram</span>
        </a>
        <a href="https://www.youtube.com/@deckctr" target="_blank" rel="noopener noreferrer" aria-label="유튜브" class="social-icon youtube">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
          </svg>
          <span>YouTube</span>
        </a>
        <a href="https://blog.naver.com/deckctr" target="_blank" rel="noopener noreferrer" aria-label="네이버 블로그" class="social-icon naver">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16.273 12.845L7.376 0H0v24h7.727V11.155L16.624 24H24V0h-7.727v12.845z"/>
          </svg>
          <span>Blog</span>
        </a>
        <a href="https://pf.kakao.com/_deckctr" target="_blank" rel="noopener noreferrer" aria-label="카카오톡 채널" class="social-icon kakao">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 3c-5.523 0-10 3.582-10 8 0 2.845 1.888 5.34 4.727 6.756-.147.534-.552 2.013-.633 2.323-.098.378.139.372.293.271.121-.08 1.927-1.31 2.709-1.84.941.136 1.912.206 2.904.206 5.523 0 10-3.582 10-8s-4.477-8-10-8z"/>
          </svg>
          <span>KakaoTalk</span>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .products-grid,
  .cases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2.5rem;
    margin-bottom: 2rem;
  }

  .trust-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.5rem;
  }

  .trust-item {
    background: white;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .trust-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 66, 80, 0.1);
  }

  .trust-item h3 {
    margin-bottom: 0.5rem;
    font-size: 1.2rem;
  }

  .trust-item p {
    color: var(--color-text-light);
  }

  .process-steps {
    list-style: none;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.5rem;
  }

  .process-step {
    background: white;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .process-step:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 66, 80, 0.1);
  }

  .step-number {
    display: inline-block;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    color: var(--color-accent);
    margin-bottom: 0.75rem;
  }

  .process-step h3 {
    margin-bottom: 0.5rem;
  }

  .process-step p {
    color: var(--color-text-light);
  }

  .guides-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .guide-card {
    background: white;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .guide-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0, 66, 80, 0.12);
  }

  .guide-media img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  .guide-content {
    padding: 1.5rem;
  }

  .guide-content h3 {
    margin-bottom: 0.75rem;
    font-size: 1.15rem;
  }

  .guide-content h3 a {
    color: var(--color-primary);
  }

  .guide-content p {
    color: var(--color-text-light);
    font-size: 0.95rem;
  }

  .guide-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
  }

  .guide-tag {
    background: var(--color-gray-100);
    color: var(--color-secondary);
    padding: 0.2rem 0.65rem;
    border-radius: 999px;
    font-size: 0.75rem;
    letter-spacing: 0.08em;
  }

  .more-link {
    text-align: center;
    margin-top: 2rem;
  }

  .more-link a {
    color: var(--color-accent);
    font-weight: 600;
  }

  .cta-section {
    text-align: center;
    padding: 4rem;
    background: linear-gradient(180deg, var(--color-bg-alt) 0%, #ffffff 100%);
    border-radius: 20px;
    border: 1px solid rgba(0,0,0,0.05);
    box-shadow: 0 4px 24px rgba(0,0,0,0.06);
  }

  .cta-section p {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    color: var(--color-secondary);
  }

  /* Testimonials Grid */
  .testimonials-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
  }

  /* Stats Grid */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
    background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
    border-radius: 16px;
    padding: 2.5rem 2rem;
  }

  .stat-item {
    text-align: center;
    color: white;
  }

  .stat-number {
    display: block;
    font-size: 2.5rem;
    font-weight: 800;
    line-height: 1.2;
    margin-bottom: 0.5rem;
  }

  .stat-label {
    font-size: 0.95rem;
    opacity: 0.9;
  }

  /* Social Section */
  .social-section {
    padding: 4rem 2rem;
    background: linear-gradient(180deg, var(--color-bg-alt) 0%, var(--color-bg) 100%);
  }

  .social-container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
  }

  .social-container h2 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  .social-container > p {
    color: var(--color-text-light);
    margin-bottom: 2rem;
  }

  .social-icons {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    flex-wrap: wrap;
  }

  .social-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1.5rem 2rem;
    background: white;
    border-radius: 16px;
    border: 1px solid rgba(0,0,0,0.05);
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: all 0.3s ease;
    color: var(--color-primary);
    min-width: 120px;
  }

  .social-icon:hover {
    transform: translateY(-6px);
    box-shadow: 0 12px 32px rgba(0,0,0,0.12);
  }

  .social-icon span {
    font-size: 0.9rem;
    font-weight: 600;
  }

  .social-icon.instagram:hover {
    background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
    color: white;
  }

  .social-icon.youtube:hover {
    background: #FF0000;
    color: white;
  }

  .social-icon.naver:hover {
    background: #03C75A;
    color: white;
  }

  .social-icon.kakao:hover {
    background: #FEE500;
    color: #191919;
  }

  /* Dark mode social icons */
  :global([data-theme="dark"]) .social-icon {
    background: var(--color-bg-alt);
    border-color: rgba(255,255,255,0.1);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }

  :global([data-theme="dark"]) .social-icon:hover {
    box-shadow: 0 12px 32px rgba(0,0,0,0.5);
  }

  @media (max-width: 768px) {
    .testimonials-grid {
      grid-template-columns: 1fr;
    }

    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
      padding: 2rem 1.5rem;
    }

    .stat-number {
      font-size: 2rem;
    }

    .social-icons {
      gap: 1rem;
    }

    .social-icon {
      padding: 1rem 1.5rem;
      min-width: 100px;
    }
  }
</style>
