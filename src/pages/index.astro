---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import Card from '../components/Card.astro';
import Section from '../components/Section.astro';
import CTA from '../components/CTA.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

const products: CollectionEntry<'products'>[] = await getCollection('products');

const cases: CollectionEntry<'cases'>[] = (await getCollection('cases')).slice(0, 3);

const blogPosts: CollectionEntry<'blog'>[] = await getCollection('blog');
const guidePosts = blogPosts
  .filter((post) => post.data.tags.includes('소재비교') || post.data.tags.includes('가이드'))
  .slice(0, 3);

const productCards = [
  {
    title: "목재 데크",
    description: "자연의 질감과 따뜻한 감성",
    image: "https://images.unsplash.com/photo-1590059392209-799446d3283c?auto=format&fit=crop&q=80&w=800",
    link: "/products/wood"
  },
  {
    title: "합성목/WPC",
    description: "유지보수 걱정 없는 현대적 솔루션",
    image: "https://images.unsplash.com/photo-1544033333-722a4667469a?auto=format&fit=crop&q=80&w=800",
    link: "/products/composite"
  },
  {
    title: "알루미늄 데크",
    description: "반영구적 수명과 완벽한 내화성",
    image: "https://images.unsplash.com/photo-1598928506311-c55ded91a20c?auto=format&fit=crop&q=80&w=800",
    link: "/products/aluminum"
  },
  {
    title: "부자재/난간",
    description: "시공의 완성도를 높이는 디테일",
    image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&q=80&w=800",
    link: "/products/accessories"
  }
];
---

<BaseLayout>
  <div class="hero-wrap">
    <Hero
      eyebrow="합성데크 · 합성목재 · 데크"
      title="현장에 맞는 데크 솔루션, 데크센터"
      description="시공업자와 일반 소비자 모두를 위한 내구성·품질·A/S 기준을 제안합니다. 공간과 예산에 맞는 자재를 전문가가 추천합니다."
      ctaText="견적 문의하기"
      ctaLink="https://calc.deckctr.com"
      videoUrl="/videos/hero-forest.mp4"
      image="https://images.unsplash.com/photo-1590059392209-799446d3283c?auto=format&fit=crop&q=80&w=1200"
      highlights={["내구성 기준 제안", "품질 기준 공개", "A/S 대응"]}
    />
  </div>

  <Section
    title="데크센터가 신뢰받는 이유"
    description="내구성, 품질, A/S 기준을 명확히 설명해 선택을 단순하게 만듭니다."
    variant="alt"
  >
    <div class="trust-grid">
      <div class="trust-item">
        <h3>내구성 기준</h3>
        <p>현장 환경과 사용 빈도를 고려해 수명 기준을 제안합니다.</p>
      </div>
      <div class="trust-item">
        <h3>품질 기준</h3>
        <p>소재 구조와 표면 품질 기준을 투명하게 안내합니다.</p>
      </div>
      <div class="trust-item">
        <h3>A/S 대응</h3>
        <p>유지관리와 보수 절차를 미리 정리해 제공합니다.</p>
      </div>
    </div>
  </Section>

  <Section
    title="제품 카테고리"
    description="목재부터 합성목, 알루미늄까지 목적에 맞는 자재를 한눈에 비교하세요."
  >
    <div class="products-grid">
      {productCards.map(card => (
        <Card {...card} />
      ))}
    </div>
  </Section>

  <Section
    title="상담부터 납품까지"
    description="상담과 견적, 납품까지의 흐름을 명확히 안내합니다."
    variant="alt"
  >
    <ol class="process-steps">
      <li class="process-step">
        <span class="step-number">01</span>
        <h3>현장 조건 파악</h3>
        <p>사용 목적, 환경, 예산을 기준으로 조건을 정리합니다.</p>
      </li>
      <li class="process-step">
        <span class="step-number">02</span>
        <h3>자재 추천</h3>
        <p>내구성과 디자인을 균형 있게 고려한 자재를 제안합니다.</p>
      </li>
      <li class="process-step">
        <span class="step-number">03</span>
        <h3>견적 확정</h3>
        <p>수량과 일정에 맞춘 견적을 빠르게 확정합니다.</p>
      </li>
      <li class="process-step">
        <span class="step-number">04</span>
        <h3>납품 및 관리</h3>
        <p>납품 이후 유지관리와 A/S 절차를 안내합니다.</p>
      </li>
    </ol>
  </Section>

  <Section
    title="시공사례"
    description="실제 현장에서 적용된 사례로 성능과 분위기를 확인하세요."
  >
    <div class="cases-grid">
      {cases.map((c) => (
        <Card
          title={c.data.title}
          description={c.data.excerpt}
          image={c.data.cover}
          link={`/cases/${c.slug}`}
        />
      ))}
    </div>
    <div class="more-link">
      <a href="/cases">더 많은 시공사례 보기 →</a>
    </div>
  </Section>

  <Section
    title="비교/가이드"
    description="자재 선택 기준과 유지관리 팁을 쉽고 빠르게 정리했습니다."
    variant="alt"
  >
    <div class="guides-grid">
      {guidePosts.map((post) => (
        <article class="guide-card">
          <a href={`/blog/${post.slug}`} class="guide-media">
            <img src={post.data.cover} alt={post.data.title} loading="lazy" />
          </a>
          <div class="guide-content">
            <div class="guide-tags">
              {post.data.tags.slice(0, 2).map((tag) => (
                <span class="guide-tag">{tag}</span>
              ))}
            </div>
            <h3><a href={`/blog/${post.slug}`}>{post.data.title}</a></h3>
            <p>{post.data.excerpt}</p>
          </div>
        </article>
      ))}
    </div>
    <div class="more-link">
      <a href="/guides">비교/가이드 더 보기 →</a>
    </div>
  </Section>

  <Section title="견적 문의" description="프로젝트 조건을 알려주시면 가장 적합한 자재로 제안드립니다.">
    <div class="cta-section">
      <p>전문 상담을 통해 현장에 맞는 자재와 견적을 빠르게 안내합니다.</p>
      <CTA text="견적내기" link="https://calc.deckctr.com" variant="primary" />
    </div>
  </Section>
</BaseLayout>

<style>
  .products-grid,
  .cases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2.5rem;
    margin-bottom: 2rem;
  }

  .trust-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.5rem;
  }

  .trust-item {
    background: white;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .trust-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 66, 80, 0.1);
  }

  .trust-item h3 {
    margin-bottom: 0.5rem;
    font-size: 1.2rem;
  }

  .trust-item p {
    color: var(--color-text-light);
  }

  .process-steps {
    list-style: none;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.5rem;
  }

  .process-step {
    background: white;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .process-step:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 66, 80, 0.1);
  }

  .step-number {
    display: inline-block;
    font-size: 0.85rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    color: var(--color-accent);
    margin-bottom: 0.75rem;
  }

  .process-step h3 {
    margin-bottom: 0.5rem;
  }

  .process-step p {
    color: var(--color-text-light);
  }

  .guides-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .guide-card {
    background: white;
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 16px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .guide-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0, 66, 80, 0.12);
  }

  .guide-media img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  .guide-content {
    padding: 1.5rem;
  }

  .guide-content h3 {
    margin-bottom: 0.75rem;
    font-size: 1.15rem;
  }

  .guide-content h3 a {
    color: var(--color-primary);
  }

  .guide-content p {
    color: var(--color-text-light);
    font-size: 0.95rem;
  }

  .guide-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
  }

  .guide-tag {
    background: var(--color-gray-100);
    color: var(--color-secondary);
    padding: 0.2rem 0.65rem;
    border-radius: 999px;
    font-size: 0.75rem;
    letter-spacing: 0.08em;
  }

  .more-link {
    text-align: center;
    margin-top: 2rem;
  }

  .more-link a {
    color: var(--color-accent);
    font-weight: 600;
  }

  .cta-section {
    text-align: center;
    padding: 4rem;
    background: linear-gradient(180deg, var(--color-bg-alt) 0%, #ffffff 100%);
    border-radius: 20px;
    border: 1px solid rgba(0,0,0,0.05);
    box-shadow: 0 4px 24px rgba(0,0,0,0.06);
  }

  .cta-section p {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    color: var(--color-secondary);
  }
</style>
