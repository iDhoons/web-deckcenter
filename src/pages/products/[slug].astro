---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CTA from '../../components/CTA.astro';
import Section from '../../components/Section.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const products: CollectionEntry<'products'>[] = await getCollection('products');
  return products.map((product) => ({
    params: { slug: product.slug },
    props: { product },
  }));
}

interface Props {
  product: CollectionEntry<'products'>;
}

const { product } = Astro.props;
const { Content } = await product.render();
---

<BaseLayout
  title={`${product.data.title} | 데크센터`}
  description={product.data.excerpt}
  image={product.data.cover}
>
  <div class="product-hero">
    <img src={product.data.cover} alt={product.data.title} loading="eager" />
  </div>

  <div class="product-content">
    <h1>{product.data.title}</h1>
    <p class="excerpt">{product.data.excerpt}</p>

    <Content />

    <Section title="특징">
      <ul>
        {product.data.features.map((feature) => (
          <li>{feature}</li>
        ))}
      </ul>
    </Section>

    <Section title="적합한 현장">
      <ul>
        {product.data.applications.map((app) => (
          <li>{app}</li>
        ))}
      </ul>
    </Section>

    <Section title="유지관리">
      <p>{product.data.maintenance}</p>
    </Section>

    <div class="cta-section">
      <CTA text={product.data.ctaText} link="https://calc.deckctr.com" variant="primary" />
    </div>
  </div>
</BaseLayout>

<style>
  .product-hero {
    width: 100%;
    height: 400px;
    overflow: hidden;
  }

  .product-hero img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .product-content {
    max-width: 800px;
    margin: 0 auto;
    padding: 3rem 2rem;
  }

  .product-content h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .excerpt {
    font-size: 1.25rem;
    color: #666;
    margin-bottom: 2rem;
  }

  ul {
    list-style: disc;
    margin-left: 2rem;
    margin-bottom: 1.5rem;
  }

  li {
    margin-bottom: 0.5rem;
  }

  .cta-section {
    text-align: center;
    margin-top: 3rem;
    padding: 2rem;
    background: var(--color-gray-100);
    border-radius: 8px;
  }
</style>
